<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Cache Simulator: L1cache.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cache Simulator
   &#160;<span id="projectnumber">v1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">L1cache.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_l1cache_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_l1cache_8h.html">L1cache.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="_l1cache_8h.html#af8f57e09b6c32f5eb15115bbd7683ce5">   10</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_l1cache_8c.html#af8f57e09b6c32f5eb15115bbd7683ce5">checkL1i</a>(<a class="code" href="common_8h.html#aa0f39ee33b87675e11229913d432ffe7">ui</a> currIndx, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTag, <a class="code" href="structall_cache.html">allCache</a> *cacheHier)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;{</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="comment">/* check for bad input */</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">if</span>(cacheHier == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a726e78585b11fdfb18b7ae4c14b1120e">L2</a> == NULL</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;        || cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a4bf36bcf71496282367818c38ea49a85">VCL2</a> == NULL)</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;cache not initialized&quot;</span>);</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <span class="comment">/* get the first block in the list */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="structnode.html">node</a> *tmpNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndx]-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">/* check each way for a hit */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="keywordflow">while</span>(tmpNode != NULL)</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    {</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <span class="keywordflow">if</span>(tmpNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> &amp;&amp; tmpNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> == currTag)</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        {</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;            <span class="comment">// move node to first way (LRU policy)</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndx], currTag) != 0)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="cache_8h.html#afa32d865bca6209bdaf87e7b7ccc9e1a">HIT</a>;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;            tmpNode = tmpNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;}</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="_l1cache_8h.html#ab20d28ba68db5178fb0aa64e018bfe5f">   37</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_l1cache_8c.html#ab20d28ba68db5178fb0aa64e018bfe5f">checkL1dR</a>(<a class="code" href="common_8h.html#aa0f39ee33b87675e11229913d432ffe7">ui</a> currIndx, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTag, <a class="code" href="structall_cache.html">allCache</a> *cacheHier)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">/* check for bad input */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">if</span>(cacheHier == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a726e78585b11fdfb18b7ae4c14b1120e">L2</a> == NULL</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        || cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a4bf36bcf71496282367818c38ea49a85">VCL2</a> == NULL)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;cache not initialized&quot;</span>);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">/* get the first block in the list */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="structnode.html">node</a> *tmpNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndx]-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">/* check each way for a hit */</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">while</span>(tmpNode != NULL)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">if</span>(tmpNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> &amp;&amp; tmpNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> == currTag)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <span class="comment">// move node to first way (LRU policy)</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndx], currTag) != 0)</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="cache_8h.html#afa32d865bca6209bdaf87e7b7ccc9e1a">HIT</a>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            tmpNode = tmpNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="_l1cache_8h.html#a62d0a4d2eba025550b0ee336b27937ab">   65</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_l1cache_8c.html#a62d0a4d2eba025550b0ee336b27937ab">checkL1dW</a>(<a class="code" href="common_8h.html#aa0f39ee33b87675e11229913d432ffe7">ui</a> currIndx, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTag, <a class="code" href="structall_cache.html">allCache</a> *cacheHier)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">/* check for bad input */</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span>(cacheHier == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a726e78585b11fdfb18b7ae4c14b1120e">L2</a> == NULL</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        || cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a4bf36bcf71496282367818c38ea49a85">VCL2</a> == NULL)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;cache not initialized&quot;</span>);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">/* get the first block in the list */</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="structnode.html">node</a> *tmpNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndx]-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">/* check each way for a hit */</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">while</span>(tmpNode != NULL)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span>(tmpNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> &amp;&amp; tmpNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> == currTag)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="comment">// mark block as dirty</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            tmpNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="comment">// move node to first way (LRU policy)</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;           <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndx], currTag) != 0)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;               <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="cache_8h.html#afa32d865bca6209bdaf87e7b7ccc9e1a">HIT</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            tmpNode = tmpNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a>;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="_l1cache_8h.html#a8bc51a177590750cf4d10d0ee9fcfc50">   95</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_l1cache_8c.html#a8bc51a177590750cf4d10d0ee9fcfc50">L1iMiss</a>(<a class="code" href="structperformance.html">performance</a> *stats, <a class="code" href="structmem_info.html">memInfo</a>* cacheCnfg,  <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTagL1, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTagL2, <span class="keywordtype">int</span> currIndxL1, <span class="keywordtype">int</span> currIndxL2, <a class="code" href="structall_cache.html">allCache</a> *cacheHier, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> addr)</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// check for bad input</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">if</span>(cacheHier == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a726e78585b11fdfb18b7ae4c14b1120e">L2</a> == NULL</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        || cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a4bf36bcf71496282367818c38ea49a85">VCL2</a> == NULL)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;cache not initialzed&quot;</span>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// get the first entry in the L1 victim cache</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="structnode.html">node</a> *VCL1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// get the first node from the L1 cache</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="structnode.html">node</a> *L1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// search victim cache for the tag (VC&#39;s use full address)</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">while</span>(VCL1iNode != NULL)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// the enty was found in the L1i victim cache</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span>(VCL1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> &amp;&amp; VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> == (addr &gt;&gt; <a class="code" href="cache_8h.html#a7e0044af98788804b7e01283a931753a">L1_OFFSET</a>))</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="comment">// increment statistics for simulation</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#a05cf3fa6c5f61c165ace79624a8fde3d">VChitL1i</a>++;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#a11962c09067df66c8c1fe02efca1033a">cycleInst</a> += <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>; <span class="comment">// transfer from VCL1 to L1 same as L1 hit time</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="comment">// move found entry to front of list (LRU policy)</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>, (addr &gt;&gt; <a class="code" href="cache_8h.html#a7e0044af98788804b7e01283a931753a">L1_OFFSET</a>)) != 0)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="comment">// reset VCL1iNode to its new location</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            VCL1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            <span class="comment">// swap the values in the L1i cache and VCL1i</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> tempTag = VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = (L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>) | currIndxL1;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            VCL1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            VCL1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = tempTag &gt;&gt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1], L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>) != 0)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// move to next node in the VCL1i</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        VCL1iNode = VCL1iNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// entry was not in the L1i victim cache -&gt; check L2</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#a7f829b549f41dff93384ee598feffc66">checkL2</a>(currTagL2, currIndxL2, cacheHier, <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>) == <a class="code" href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a>)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        stats-&gt;<a class="code" href="structperformance.html#af20f1f6af5037b229f060602bbfa8367">missL2</a>++;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        stats-&gt;<a class="code" href="structperformance.html#a11962c09067df66c8c1fe02efca1033a">cycleInst</a> += <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// L2 miss</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="comment">// check the up the memory hierarchy for the requested value</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#aacaf5d97d0b8a378571774dea49decf5">L2miss</a>(stats, cacheCnfg,  currTagL2, currIndxL2, cacheHier, addr, <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>, instT) == EXIT_FAILURE)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;problem L2 miss&quot;</span>);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// otherwise hit</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="comment">// increment stats</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        stats-&gt;<a class="code" href="structperformance.html#aa92769c2647488fbdc44fc55c73769ff">hitL2</a>++;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        stats-&gt;<a class="code" href="structperformance.html#a11962c09067df66c8c1fe02efca1033a">cycleInst</a> += <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// hit or miss still need to transfer value from L2 (once it is there) to L1i</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// check if there is an empty spot (not valid) in L1i</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    L1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">while</span>(L1iNode != NULL)</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keywordflow">if</span>(!L1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a>)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="comment">// mark as valid and insert into L1i</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = currTagL1;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// adhere to LRU policy</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1], currTagL1))</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        L1iNode = L1iNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// otherwise a kickout occurs</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    VCL1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    L1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">while</span>(VCL1iNode != NULL)</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// case 1: VCL1i has an available spot for the kickout from L1i</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span>(!VCL1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a>)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="comment">// transfer tag from L1i to VCL1i (L1i kickout)</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = (L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>) | currIndxL1;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            VCL1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            VCL1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = L1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="comment">// LRU policy VCL1i</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>, VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>))</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <span class="comment">// transfer from L2 to L1i</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = currTagL1;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            L1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="comment">// LRU policy L1i</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1], currTagL1))</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        VCL1iNode = VCL1iNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="comment">// case 2: kickout from L1i causes a kickout from VCL1i -&gt; move entry to L2 if dirty</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    VCL1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;         <span class="comment">// item being kicked out from VCL1i</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    L1iNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>; <span class="comment">// item being kicked out from L1i</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// kickout from L1i to VCL1i</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = (L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>) | currIndxL1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    VCL1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    VCL1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = L1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a>, VCL1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>))</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    stats-&gt;<a class="code" href="structperformance.html#a64ab5846b6d316abfd0e687d1371ffc8">kickoutL1i</a>++;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// transfer tag from L2 to L1i</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = currTagL1;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    L1iNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    L1iNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a>[currIndxL1], L1iNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>))</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="_l1cache_8h.html#a2476112488029502efb94fdc1d218b65">  242</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_l1cache_8c.html#a2476112488029502efb94fdc1d218b65">L1dMiss</a>(<a class="code" href="structperformance.html">performance</a> *stats, <a class="code" href="structmem_info.html">memInfo</a>* cacheCnfg,  <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTagL1, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> currTagL2, <span class="keywordtype">int</span> currIndxL1, <span class="keywordtype">int</span> currIndxL2, <a class="code" href="structall_cache.html">allCache</a> *cacheHier, <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> addr, <span class="keywordtype">int</span> rw, <a class="code" href="cache_8h.html#a57fb2129439cd478413299e55119399d">refT</a> refType)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;{</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// check for bad input</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span>(cacheHier == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">L1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a726e78585b11fdfb18b7ae4c14b1120e">L2</a> == NULL</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        || cacheHier-&gt;<a class="code" href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">VCL1i</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a> == NULL || cacheHier-&gt;<a class="code" href="structall_cache.html#a4bf36bcf71496282367818c38ea49a85">VCL2</a> == NULL)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;cache not initialzed&quot;</span>);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// get the first entry in the L1 victim cache</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="structnode.html">node</a> *VCL1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// get the last way from the L1 cache</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="structnode.html">node</a> *L1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// search victim cache for the tag (VC&#39;s use full address)</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">while</span>(VCL1dNode != NULL)</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    {</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">// the enty was found in the L1d victim cache</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span>(VCL1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> &amp;&amp; VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> == (addr &gt;&gt; <a class="code" href="cache_8h.html#a7e0044af98788804b7e01283a931753a">L1_OFFSET</a>))</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="comment">// move found entry to front of list (LRU policy)</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>, (addr &gt;&gt; <a class="code" href="cache_8h.html#a7e0044af98788804b7e01283a931753a">L1_OFFSET</a>)) != 0)</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="comment">// reset VCL1dNode to its new location</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            VCL1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="comment">// increment statistics for simulation</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>; <span class="comment">// VC to L1 same time as an L1 hit</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#a2a9ad4b394bd11653d8c04d07049bbd4">VChitL1d</a>++;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="comment">// swap the values in the L1d cache and VCL1d</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> swapTag = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1], swapTag) != 0)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">// swap the values in the L1d cache and VCL1d</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> tempTag = VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordtype">short</span> tempDirty = VCL1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = (L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>) | currIndxL1;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            VCL1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            VCL1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = tempTag &gt;&gt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            L1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span>(rw == <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = tempDirty;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1], L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>) != 0)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// move to next node in the VCL1d</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        VCL1dNode = VCL1dNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// entry was not in the L1d victim cache -&gt; must first make write request to L2 if there is a dirty kickout</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    L1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    VCL1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordtype">bool</span> L1dSpace = <span class="keyword">false</span>;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordtype">bool</span> VCL1dSpace = <span class="keyword">false</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">while</span>(L1dNode != NULL)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span>(!L1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a>)</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;           L1dSpace = <span class="keyword">true</span>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;           <span class="keywordflow">break</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        }</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        L1dNode = L1dNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">while</span>(VCL1dNode != NULL)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">if</span>(!VCL1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a>)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;           VCL1dSpace = <span class="keyword">true</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;           <span class="keywordflow">break</span>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        VCL1dNode = VCL1dNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// if no space in L1d and VCL1d then there is a kickout from L1d cache</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// if the kickout is dirty the write request to L2 must occur before checking L2 for the</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// value that originally triggered this request</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">if</span>(L1dSpace == <span class="keyword">false</span> &amp;&amp; VCL1dSpace == <span class="keyword">false</span>)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        VCL1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        L1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> tempTagVCL1d = VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>; <span class="comment">// tag being kickout out to L2</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordtype">short</span> tempDirty = VCL1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">// just increment stats if kickout isn&#39;t dirty</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span>(tempDirty == <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#a6d2077416756c3707c64a4d9b3348455">kickoutL1d</a>++;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// otherwise handle dirty kickout</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tempDirty == <a class="code" href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a>)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#a6d2077416756c3707c64a4d9b3348455">kickoutL1d</a>++;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#a89e8ac14f58ac0047d3a1d788cee16b3">dirtyKickL1d</a>++;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="comment">// dirty write to L2</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            <span class="comment">// convert tempTag to L2 tag format</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> tempaddr = tempTagVCL1d &lt;&lt; <a class="code" href="cache_8h.html#a7e0044af98788804b7e01283a931753a">L1_OFFSET</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            <span class="keywordtype">int</span> tempIndx = (tempaddr &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#af511213ae3e6889d06ba2954b0742267">bitsTagL2</a>) &gt;&gt; (cacheCnfg-&gt;<a class="code" href="structmem_info.html#af511213ae3e6889d06ba2954b0742267">bitsTagL2</a> + <a class="code" href="cache_8h.html#a7fdcfc866446c76c90a964133b733c65">L2_OFFSET</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <a class="code" href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a> tempTag = tempaddr &gt;&gt; (cacheCnfg-&gt;<a class="code" href="structmem_info.html#ac5597ee7d7209c96bd0266166f797582">bitsIndexL2</a> + <a class="code" href="cache_8h.html#a7fdcfc866446c76c90a964133b733c65">L2_OFFSET</a>);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            <span class="comment">// check if tag is already in L2 -&gt; if so it is marked dirty</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#a7f829b549f41dff93384ee598feffc66">checkL2</a>(tempTag, tempIndx, cacheHier, <a class="code" href="cache_8h.html#aa10f470e996d0f51210d24f442d25e1e">WRITE</a>) == <a class="code" href="cache_8h.html#afa32d865bca6209bdaf87e7b7ccc9e1a">HIT</a>)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#aa92769c2647488fbdc44fc55c73769ff">hitL2</a>++;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                    stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="comment">// otherwise write value to L2</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            {</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#af20f1f6af5037b229f060602bbfa8367">missL2</a>++;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                    stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#aacaf5d97d0b8a378571774dea49decf5">L2miss</a>(stats, cacheCnfg,  tempTag, tempIndx, cacheHier, tempaddr, <a class="code" href="cache_8h.html#aa10f470e996d0f51210d24f442d25e1e">WRITE</a>, refType) == EXIT_FAILURE)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;problem L2 miss&quot;</span>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        }</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="comment">// kickout from L1d to VCL1d</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = (L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>) | currIndxL1;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        VCL1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        VCL1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>, VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>))</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// now check L2 for the original request</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#a7f829b549f41dff93384ee598feffc66">checkL2</a>(currTagL2, currIndxL2, cacheHier, <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>) == <a class="code" href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a>)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#af20f1f6af5037b229f060602bbfa8367">missL2</a>++;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="comment">// L2 miss</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="comment">// check the up the memory hierarchy for the requested value</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#aacaf5d97d0b8a378571774dea49decf5">L2miss</a>(stats, cacheCnfg,  currTagL2, currIndxL2, cacheHier, addr, <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>, refType) == EXIT_FAILURE)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;problem L2 miss&quot;</span>);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">// otherwise hit</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="comment">// increment stats</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#aa92769c2647488fbdc44fc55c73769ff">hitL2</a>++;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="comment">// transfer tag from L2 to L1d</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = currTagL1;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        L1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">if</span>(rw == <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>)</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1], L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>))</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// item was not in VCL1d and there is not a kickout from L1</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="comment">// entry was not in the L1d victim cache -&gt; check L2</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#a7f829b549f41dff93384ee598feffc66">checkL2</a>(currTagL2, currIndxL2, cacheHier, <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>) == <a class="code" href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a>)</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#af20f1f6af5037b229f060602bbfa8367">missL2</a>++;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="comment">// L2 miss</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            <span class="comment">// check the up the memory hierarchy for the requested value</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="_l2cache_8c.html#aacaf5d97d0b8a378571774dea49decf5">L2miss</a>(stats, cacheCnfg,  currTagL2, currIndxL2, cacheHier, addr, <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>, refType) == EXIT_FAILURE)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;problem L2 miss&quot;</span>);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <span class="comment">// otherwise hit</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            <span class="comment">// increment stats</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            stats-&gt;<a class="code" href="structperformance.html#aa92769c2647488fbdc44fc55c73769ff">hitL2</a>++;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">if</span>(refType == dataTR)</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#aa0413a59fb614215ee26401efc391fde">cycleDRead</a> += <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                stats-&gt;<a class="code" href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">cycleDWrite</a> += <a class="code" href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a> + <a class="code" href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a> + <a class="code" href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="comment">// hit or miss still need to transfer value from L2 (once it is there) to L1d</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">// check if there is an empty spot (not valid) in L1d</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        L1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="keywordflow">while</span>(L1dNode != NULL)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            <span class="keywordflow">if</span>(!L1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="comment">// mark as valid and insert into L1d</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                L1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = currTagL1;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                <span class="keywordflow">if</span>(rw == <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a>;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                <span class="comment">// adhere to LRU policy</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1], currTagL1))</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            }</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            L1dNode = L1dNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="comment">// otherwise a kickout occurs</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        VCL1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>-&gt;<a class="code" href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">first</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        L1dNode = cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1]-&gt;<a class="code" href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">last</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keywordflow">while</span>(VCL1dNode != NULL)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        {</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="comment">// VCL1d has an available spot for the kickout from L1d</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">if</span>(!VCL1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a>)</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            {</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <span class="comment">// transfer tag from L1d to VCL1d (L1d kickout)</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = (L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> &lt;&lt; cacheCnfg-&gt;<a class="code" href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">bitsIndexL1</a>) | currIndxL1;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                VCL1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                VCL1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="comment">// LRU policy VCL1d</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">VCL1d</a>, VCL1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a>))</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                    <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                <span class="comment">// transfer from L2 to L1d</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                L1dNode-&gt;<a class="code" href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">valid</a> = 1;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                L1dNode-&gt;<a class="code" href="structnode.html#a62913859238d218110e429653857d04f">tag</a> = currTagL1;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                <span class="keywordflow">if</span>(rw == <a class="code" href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a>)</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    L1dNode-&gt;<a class="code" href="structnode.html#a7906ff236bc75af8aae9235e47c48374">dirty</a> = <a class="code" href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="comment">// LRU policy L1d</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a>(cacheHier-&gt;<a class="code" href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">L1d</a>[currIndxL1], currTagL1))</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;bumpToFirst failed&quot;</span>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <span class="keywordflow">return</span> EXIT_SUCCESS;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;            }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            VCL1dNode = VCL1dNode-&gt;<a class="code" href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">next</a>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a>(<span class="stringliteral">&quot;all cases should be covered before this point&quot;</span>);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div><div class="ttc" id="structall_cache_html_a726e78585b11fdfb18b7ae4c14b1120e"><div class="ttname"><a href="structall_cache.html#a726e78585b11fdfb18b7ae4c14b1120e">allCache::L2</a></div><div class="ttdeci">list ** L2</div><div class="ttdoc">the L2 cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00060">cache.h:60</a></div></div>
<div class="ttc" id="common_8h_html_a1250e0ed87b5baa5422f5b6feaaac030"><div class="ttname"><a href="common_8h.html#a1250e0ed87b5baa5422f5b6feaaac030">PERR</a></div><div class="ttdeci">#define PERR(M,...)</div><div class="ttdoc">macro to print an error message to stderr, uses var args to accept printf format input, returns EXIT_FAILURE </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00016">common.h:16</a></div></div>
<div class="ttc" id="cache_8h_html_a0fd3f1b64981a1a9937bf15ed0ff4fa7"><div class="ttname"><a href="cache_8h.html#a0fd3f1b64981a1a9937bf15ed0ff4fa7">L2_HIT_T</a></div><div class="ttdeci">#define L2_HIT_T</div><div class="ttdoc">number of cycles to return an L2 hit </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00033">cache.h:33</a></div></div>
<div class="ttc" id="structnode_html"><div class="ttname"><a href="structnode.html">node</a></div><div class="ttdoc">typedef for the node structure (contains variables necessary for each node) </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00024">dlinkedList.h:24</a></div></div>
<div class="ttc" id="structperformance_html_aa92769c2647488fbdc44fc55c73769ff"><div class="ttname"><a href="structperformance.html#aa92769c2647488fbdc44fc55c73769ff">performance::hitL2</a></div><div class="ttdeci">ulli hitL2</div><div class="ttdoc">hit count L2 cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00079">cache.h:79</a></div></div>
<div class="ttc" id="structall_cache_html_a2b2d19dfc5a73918f39e4c73f1e6d302"><div class="ttname"><a href="structall_cache.html#a2b2d19dfc5a73918f39e4c73f1e6d302">allCache::VCL1d</a></div><div class="ttdeci">list * VCL1d</div><div class="ttdoc">the L1 data victim cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00062">cache.h:62</a></div></div>
<div class="ttc" id="cache_8h_html_a44506c85d3e6d1b0e94804565ce9300b"><div class="ttname"><a href="cache_8h.html#a44506c85d3e6d1b0e94804565ce9300b">L1_HIT_T</a></div><div class="ttdeci">#define L1_HIT_T</div><div class="ttdoc">number of cycles to return an L1 hit </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00031">cache.h:31</a></div></div>
<div class="ttc" id="structmem_info_html_ac5597ee7d7209c96bd0266166f797582"><div class="ttname"><a href="structmem_info.html#ac5597ee7d7209c96bd0266166f797582">memInfo::bitsIndexL2</a></div><div class="ttdeci">int bitsIndexL2</div><div class="ttdoc">number of bits for L2 index </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00057">config.h:57</a></div></div>
<div class="ttc" id="structperformance_html_a6d2077416756c3707c64a4d9b3348455"><div class="ttname"><a href="structperformance.html#a6d2077416756c3707c64a4d9b3348455">performance::kickoutL1d</a></div><div class="ttdeci">ulli kickoutL1d</div><div class="ttdoc">total kickouts L1 data cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00084">cache.h:84</a></div></div>
<div class="ttc" id="structnode_html_a62913859238d218110e429653857d04f"><div class="ttname"><a href="structnode.html#a62913859238d218110e429653857d04f">node::tag</a></div><div class="ttdeci">ulli tag</div><div class="ttdoc">the tag for a specific address </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00028">dlinkedList.h:28</a></div></div>
<div class="ttc" id="structnode_html_aa3e8aa83f864292b5a01210f4453fcc0"><div class="ttname"><a href="structnode.html#aa3e8aa83f864292b5a01210f4453fcc0">node::next</a></div><div class="ttdeci">struct node * next</div><div class="ttdoc">pointer to the next node in the linked list </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00029">dlinkedList.h:29</a></div></div>
<div class="ttc" id="cache_8h_html_ada74e7db007a68e763f20c17f2985356"><div class="ttname"><a href="cache_8h.html#ada74e7db007a68e763f20c17f2985356">READ</a></div><div class="ttdeci">#define READ</div><div class="ttdoc">data read operation </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00023">cache.h:23</a></div></div>
<div class="ttc" id="structperformance_html_a13ba20a921addab63fdc468e75a4fb6a"><div class="ttname"><a href="structperformance.html#a13ba20a921addab63fdc468e75a4fb6a">performance::cycleDWrite</a></div><div class="ttdeci">ulli cycleDWrite</div><div class="ttdoc">number of cycles spent on data writes </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00075">cache.h:75</a></div></div>
<div class="ttc" id="cache_8h_html_aa493f2bb6c3ca1d3f0e4321978922e5d"><div class="ttname"><a href="cache_8h.html#aa493f2bb6c3ca1d3f0e4321978922e5d">L2_TRANSFER_T</a></div><div class="ttdeci">#define L2_TRANSFER_T</div><div class="ttdoc">time to transfer a value from L2 to L1 cache (based on 16 byte bus) </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00035">cache.h:35</a></div></div>
<div class="ttc" id="_l1cache_8c_html_af8f57e09b6c32f5eb15115bbd7683ce5"><div class="ttname"><a href="_l1cache_8c.html#af8f57e09b6c32f5eb15115bbd7683ce5">checkL1i</a></div><div class="ttdeci">int checkL1i(ui currIndx, ulli currTag, allCache *cacheHier)</div><div class="ttdoc">check if instruction reference is a hit or a miss </div><div class="ttdef"><b>Definition:</b> <a href="_l1cache_8c_source.html#l00010">L1cache.c:10</a></div></div>
<div class="ttc" id="_l1cache_8c_html_a2476112488029502efb94fdc1d218b65"><div class="ttname"><a href="_l1cache_8c.html#a2476112488029502efb94fdc1d218b65">L1dMiss</a></div><div class="ttdeci">int L1dMiss(performance *stats, memInfo *cacheCnfg, ulli currTagL1, ulli currTagL2, int currIndxL1, int currIndxL2, allCache *cacheHier, ulli addr, int rw, refT refType)</div><div class="ttdoc">upon a miss in the L1 data cache this function is called </div><div class="ttdef"><b>Definition:</b> <a href="_l1cache_8c_source.html#l00242">L1cache.c:242</a></div></div>
<div class="ttc" id="structperformance_html_af20f1f6af5037b229f060602bbfa8367"><div class="ttname"><a href="structperformance.html#af20f1f6af5037b229f060602bbfa8367">performance::missL2</a></div><div class="ttdeci">ulli missL2</div><div class="ttdoc">miss count L2 cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00082">cache.h:82</a></div></div>
<div class="ttc" id="_l2cache_8c_html_a7f829b549f41dff93384ee598feffc66"><div class="ttname"><a href="_l2cache_8c.html#a7f829b549f41dff93384ee598feffc66">checkL2</a></div><div class="ttdeci">int checkL2(ulli currTag, ulli currIndx, allCache *cacheHier, int rw)</div><div class="ttdoc">check reference is a hit or a miss </div><div class="ttdef"><b>Definition:</b> <a href="_l2cache_8c_source.html#l00010">L2cache.c:10</a></div></div>
<div class="ttc" id="structlist_html_a19d6b0fffc8973f372b3effc9d3d9405"><div class="ttname"><a href="structlist.html#a19d6b0fffc8973f372b3effc9d3d9405">list::last</a></div><div class="ttdeci">node * last</div><div class="ttdoc">pointer to the last node in the linked list </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00038">dlinkedList.h:38</a></div></div>
<div class="ttc" id="cache_8h_html_ab78f34451c5c2be60321d0fa2fc0daac"><div class="ttname"><a href="cache_8h.html#ab78f34451c5c2be60321d0fa2fc0daac">DIRTY</a></div><div class="ttdeci">#define DIRTY</div><div class="ttdoc">dirty bit status </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00022">cache.h:22</a></div></div>
<div class="ttc" id="structall_cache_html"><div class="ttname"><a href="structall_cache.html">allCache</a></div><div class="ttdoc">structure to hold pointers to all cache levels </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00056">cache.h:56</a></div></div>
<div class="ttc" id="cache_8h_html_a35321edda7ad4639415e2461e6ffee97"><div class="ttname"><a href="cache_8h.html#a35321edda7ad4639415e2461e6ffee97">CLEAN</a></div><div class="ttdeci">#define CLEAN</div><div class="ttdoc">dirty bit status </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00021">cache.h:21</a></div></div>
<div class="ttc" id="structmem_info_html_af511213ae3e6889d06ba2954b0742267"><div class="ttname"><a href="structmem_info.html#af511213ae3e6889d06ba2954b0742267">memInfo::bitsTagL2</a></div><div class="ttdeci">int bitsTagL2</div><div class="ttdoc">number of bits for L2 tag </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00058">config.h:58</a></div></div>
<div class="ttc" id="dlinked_list_8c_html_a88ca64b9ab55a6f69d93621f15c05b65"><div class="ttname"><a href="dlinked_list_8c.html#a88ca64b9ab55a6f69d93621f15c05b65">bumpToFirst</a></div><div class="ttdeci">int bumpToFirst(list *q, ulli tag)</div><div class="ttdoc">bumps tagged node to front of list </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8c_source.html#l00222">dlinkedList.c:222</a></div></div>
<div class="ttc" id="structperformance_html"><div class="ttname"><a href="structperformance.html">performance</a></div><div class="ttdoc">structure used to hold results of simulation such as times, CPI, cost, etc. </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00069">cache.h:69</a></div></div>
<div class="ttc" id="structlist_html_a5a4e9efe30feea9f32e114dcbdc1cbfe"><div class="ttname"><a href="structlist.html#a5a4e9efe30feea9f32e114dcbdc1cbfe">list::first</a></div><div class="ttdeci">node * first</div><div class="ttdoc">pointer to the first node in the linked list </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00037">dlinkedList.h:37</a></div></div>
<div class="ttc" id="structall_cache_html_ad3450171e9b973943475e37f89de7d74"><div class="ttname"><a href="structall_cache.html#ad3450171e9b973943475e37f89de7d74">allCache::VCL1i</a></div><div class="ttdeci">list * VCL1i</div><div class="ttdoc">the L1 instruction victim cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00061">cache.h:61</a></div></div>
<div class="ttc" id="structall_cache_html_a4bf36bcf71496282367818c38ea49a85"><div class="ttname"><a href="structall_cache.html#a4bf36bcf71496282367818c38ea49a85">allCache::VCL2</a></div><div class="ttdeci">list * VCL2</div><div class="ttdoc">the L2 victim cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00063">cache.h:63</a></div></div>
<div class="ttc" id="_l1cache_8c_html_a62d0a4d2eba025550b0ee336b27937ab"><div class="ttname"><a href="_l1cache_8c.html#a62d0a4d2eba025550b0ee336b27937ab">checkL1dW</a></div><div class="ttdeci">int checkL1dW(ui currIndx, ulli currTag, allCache *cacheHier)</div><div class="ttdoc">check if data write reference is a hit or a miss, sets dirty bit if hit occurs </div><div class="ttdef"><b>Definition:</b> <a href="_l1cache_8c_source.html#l00065">L1cache.c:65</a></div></div>
<div class="ttc" id="structperformance_html_a2a9ad4b394bd11653d8c04d07049bbd4"><div class="ttname"><a href="structperformance.html#a2a9ad4b394bd11653d8c04d07049bbd4">performance::VChitL1d</a></div><div class="ttdeci">ulli VChitL1d</div><div class="ttdoc">victim cache hit count L1 data cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00093">cache.h:93</a></div></div>
<div class="ttc" id="structmem_info_html_ae5221690a4c89fc8623f233f303be1f0"><div class="ttname"><a href="structmem_info.html#ae5221690a4c89fc8623f233f303be1f0">memInfo::bitsIndexL1</a></div><div class="ttdeci">int bitsIndexL1</div><div class="ttdoc">number of bits for L1 index </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00055">config.h:55</a></div></div>
<div class="ttc" id="structperformance_html_a89e8ac14f58ac0047d3a1d788cee16b3"><div class="ttname"><a href="structperformance.html#a89e8ac14f58ac0047d3a1d788cee16b3">performance::dirtyKickL1d</a></div><div class="ttdeci">ulli dirtyKickL1d</div><div class="ttdoc">total kickouts L1 data cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00087">cache.h:87</a></div></div>
<div class="ttc" id="structperformance_html_a11962c09067df66c8c1fe02efca1033a"><div class="ttname"><a href="structperformance.html#a11962c09067df66c8c1fe02efca1033a">performance::cycleInst</a></div><div class="ttdeci">ulli cycleInst</div><div class="ttdoc">number of cycles spent on instructions </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00076">cache.h:76</a></div></div>
<div class="ttc" id="cache_8h_html_a57fb2129439cd478413299e55119399d"><div class="ttname"><a href="cache_8h.html#a57fb2129439cd478413299e55119399d">refT</a></div><div class="ttdeci">refT</div><div class="ttdoc">determines if request is data or instruction - value is passed to L2 to determine cycles ...</div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00041">cache.h:41</a></div></div>
<div class="ttc" id="cache_8h_html_a1aa2f536390669bc40983fb02ddb2c2d"><div class="ttname"><a href="cache_8h.html#a1aa2f536390669bc40983fb02ddb2c2d">L2_MISS_T</a></div><div class="ttdeci">#define L2_MISS_T</div><div class="ttdoc">number of cycles to determine an L2 request is a miss and make request to main memory ...</div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00034">cache.h:34</a></div></div>
<div class="ttc" id="structnode_html_a7906ff236bc75af8aae9235e47c48374"><div class="ttname"><a href="structnode.html#a7906ff236bc75af8aae9235e47c48374">node::dirty</a></div><div class="ttdeci">short dirty</div><div class="ttdoc">marks if a block has been written to </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00027">dlinkedList.h:27</a></div></div>
<div class="ttc" id="structperformance_html_aa0413a59fb614215ee26401efc391fde"><div class="ttname"><a href="structperformance.html#aa0413a59fb614215ee26401efc391fde">performance::cycleDRead</a></div><div class="ttdeci">ulli cycleDRead</div><div class="ttdoc">number of cycles spent on data reads </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00074">cache.h:74</a></div></div>
<div class="ttc" id="structmem_info_html"><div class="ttname"><a href="structmem_info.html">memInfo</a></div><div class="ttdoc">contains variables about the memory system configuration in use </div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00029">config.h:29</a></div></div>
<div class="ttc" id="common_8h_html_afebafa022413aaef27ce1b01cbfa9791"><div class="ttname"><a href="common_8h.html#afebafa022413aaef27ce1b01cbfa9791">ulli</a></div><div class="ttdeci">unsigned long long int ulli</div><div class="ttdoc">shorten long type </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00010">common.h:10</a></div></div>
<div class="ttc" id="structperformance_html_a05cf3fa6c5f61c165ace79624a8fde3d"><div class="ttname"><a href="structperformance.html#a05cf3fa6c5f61c165ace79624a8fde3d">performance::VChitL1i</a></div><div class="ttdeci">ulli VChitL1i</div><div class="ttdoc">victim cache hit count L1 instruction cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00092">cache.h:92</a></div></div>
<div class="ttc" id="common_8h_html_aa0f39ee33b87675e11229913d432ffe7"><div class="ttname"><a href="common_8h.html#aa0f39ee33b87675e11229913d432ffe7">ui</a></div><div class="ttdeci">unsigned int ui</div><div class="ttdoc">maintain same format as ulli </div><div class="ttdef"><b>Definition:</b> <a href="common_8h_source.html#l00011">common.h:11</a></div></div>
<div class="ttc" id="structall_cache_html_a82eca3b26c8670d3d8d405e85c7b10e5"><div class="ttname"><a href="structall_cache.html#a82eca3b26c8670d3d8d405e85c7b10e5">allCache::L1d</a></div><div class="ttdeci">list ** L1d</div><div class="ttdoc">the L1 data cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00059">cache.h:59</a></div></div>
<div class="ttc" id="cache_8h_html_a7e0044af98788804b7e01283a931753a"><div class="ttname"><a href="cache_8h.html#a7e0044af98788804b7e01283a931753a">L1_OFFSET</a></div><div class="ttdeci">#define L1_OFFSET</div><div class="ttdoc">L1 is 32 bytes i.e. 2^5. </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00019">cache.h:19</a></div></div>
<div class="ttc" id="cache_8h_html_aa10f470e996d0f51210d24f442d25e1e"><div class="ttname"><a href="cache_8h.html#aa10f470e996d0f51210d24f442d25e1e">WRITE</a></div><div class="ttdeci">#define WRITE</div><div class="ttdoc">data write operation </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00024">cache.h:24</a></div></div>
<div class="ttc" id="structnode_html_aa4fa3079ce1a14d45c3d3f519dc56098"><div class="ttname"><a href="structnode.html#aa4fa3079ce1a14d45c3d3f519dc56098">node::valid</a></div><div class="ttdeci">short valid</div><div class="ttdoc">marks if a block contains valid information </div><div class="ttdef"><b>Definition:</b> <a href="dlinked_list_8h_source.html#l00026">dlinkedList.h:26</a></div></div>
<div class="ttc" id="cache_8h_html_a7fdcfc866446c76c90a964133b733c65"><div class="ttname"><a href="cache_8h.html#a7fdcfc866446c76c90a964133b733c65">L2_OFFSET</a></div><div class="ttdeci">#define L2_OFFSET</div><div class="ttdoc">L2 is 64 bytes i.e. 2^6. </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00020">cache.h:20</a></div></div>
<div class="ttc" id="structall_cache_html_a07dcd4cc72e6c4596eea30f2aec617bd"><div class="ttname"><a href="structall_cache.html#a07dcd4cc72e6c4596eea30f2aec617bd">allCache::L1i</a></div><div class="ttdeci">list ** L1i</div><div class="ttdoc">the L1 instruction cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00058">cache.h:58</a></div></div>
<div class="ttc" id="_l2cache_8c_html_aacaf5d97d0b8a378571774dea49decf5"><div class="ttname"><a href="_l2cache_8c.html#aacaf5d97d0b8a378571774dea49decf5">L2miss</a></div><div class="ttdeci">int L2miss(performance *stats, memInfo *cacheCnfg, ulli currTagL2, ulli currIndxL2, allCache *cacheHier, ulli addr, int rw, refT refType)</div><div class="ttdoc">if a miss occurs in the L2 cache this function is called to check the victim cache. If the desired tag is not in the victim cache it is brought in from main memory </div><div class="ttdef"><b>Definition:</b> <a href="_l2cache_8c_source.html#l00040">L2cache.c:40</a></div></div>
<div class="ttc" id="cache_8h_html_a614c0d93bfbf181f442e30e1c27b27ae"><div class="ttname"><a href="cache_8h.html#a614c0d93bfbf181f442e30e1c27b27ae">MISS</a></div><div class="ttdeci">#define MISS</div><div class="ttdoc">used as a return value for a cache miss </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00018">cache.h:18</a></div></div>
<div class="ttc" id="_l1cache_8c_html_a8bc51a177590750cf4d10d0ee9fcfc50"><div class="ttname"><a href="_l1cache_8c.html#a8bc51a177590750cf4d10d0ee9fcfc50">L1iMiss</a></div><div class="ttdeci">int L1iMiss(performance *stats, memInfo *cacheCnfg, ulli currTagL1, ulli currTagL2, int currIndxL1, int currIndxL2, allCache *cacheHier, ulli addr)</div><div class="ttdoc">upon a miss in the L1 instruction cache this function is called </div><div class="ttdef"><b>Definition:</b> <a href="_l1cache_8c_source.html#l00095">L1cache.c:95</a></div></div>
<div class="ttc" id="cache_8h_html_afa32d865bca6209bdaf87e7b7ccc9e1a"><div class="ttname"><a href="cache_8h.html#afa32d865bca6209bdaf87e7b7ccc9e1a">HIT</a></div><div class="ttdeci">#define HIT</div><div class="ttdoc">used as a return value for a cache hit </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00017">cache.h:17</a></div></div>
<div class="ttc" id="structperformance_html_a64ab5846b6d316abfd0e687d1371ffc8"><div class="ttname"><a href="structperformance.html#a64ab5846b6d316abfd0e687d1371ffc8">performance::kickoutL1i</a></div><div class="ttdeci">ulli kickoutL1i</div><div class="ttdoc">total kickouts L1 instruction cache </div><div class="ttdef"><b>Definition:</b> <a href="cache_8h_source.html#l00083">cache.h:83</a></div></div>
<div class="ttc" id="_l1cache_8h_html"><div class="ttname"><a href="_l1cache_8h.html">L1cache.h</a></div><div class="ttdoc">Function prototypes for the L1 cache. </div></div>
<div class="ttc" id="_l1cache_8c_html_ab20d28ba68db5178fb0aa64e018bfe5f"><div class="ttname"><a href="_l1cache_8c.html#ab20d28ba68db5178fb0aa64e018bfe5f">checkL1dR</a></div><div class="ttdeci">int checkL1dR(ui currIndx, ulli currTag, allCache *cacheHier)</div><div class="ttdoc">check if data read reference is a hit or a miss </div><div class="ttdef"><b>Definition:</b> <a href="_l1cache_8c_source.html#l00037">L1cache.c:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
